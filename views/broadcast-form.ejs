<% // views/broadcast-form.ejs (–£–õ–£–ß–®–ï–ù–ù–ê–Ø –í–ï–†–°–Ø) %>

<%- contentFor('body') %>

<div class="card shadow-sm">
  <div class="card-header d-flex align-items-center justify-content-between">
    <span class="h5 mb-0">üì¢ –†–∞—Å—Å—ã–ª–∫–∞</span>
    <a href="/dashboard" class="btn btn-sm btn-outline-secondary">–ù–∞–∑–∞–¥</a>
  </div>
  <div class="card-body">
    <% if (error) { %>
      <div class="alert alert-danger" data-autohide><%= error %></div>
    <% } %>
    <% if (success) { %>
      <div class="alert alert-success" data-autohide><%= success %></div>
    <% } %>
    
    <form method="post" action="/broadcast" enctype="multipart/form-data">
      <!-- –ü–æ–ª–µ –¥–ª—è —Ç–µ–∫—Å—Ç–∞ —Å–æ–æ–±—â–µ–Ω–∏—è -->
      <div class="mb-3">
        <label for="message" class="form-label">–¢–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è (–ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç Markdown: *–∂–∏—Ä–Ω—ã–π*, _–∫—É—Ä—Å–∏–≤_)</label>
        <textarea name="message" id="message" class="form-control" rows="5" placeholder="–°–æ–æ–±—â–µ–Ω–∏–µ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π..." required></textarea>
      </div>

      <!-- –ü–æ–ª–µ –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –∞—É–¥–∏–æ—Ñ–∞–π–ª–∞ -->
      <div class="mb-3">
        <label for="audio" class="form-label">–ê—É–¥–∏–æ-—Ñ–∞–π–ª (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)</label>
        <input type="file" name="audio" id="audio" accept="audio/*" class="form-control" />
      </div>

      <!-- –ù–û–í–´–ï –ü–û–õ–Ø: –°–µ–≥–º–µ–Ω—Ç–∞—Ü–∏—è –∏ –æ–ø—Ü–∏–∏ -->
      <div class="row">
        <div class="col-md-8 mb-3">
          <label for="targetAudience" class="form-label">–¶–µ–ª–µ–≤–∞—è –∞—É–¥–∏—Ç–æ—Ä–∏—è</label>
          <select class="form-select" id="targetAudience" name="targetAudience">
            <option value="all" selected>–í—Å–µ–º –∞–∫—Ç–∏–≤–Ω—ã–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º</option>
            <option value="free_users">–¢–æ–ª—å–∫–æ —Å —Ç–∞—Ä–∏—Ñ–æ–º Free</option>
            <option value="premium_users">–¢–æ–ª—å–∫–æ —Å –ø–ª–∞—Ç–Ω—ã–º–∏ —Ç–∞—Ä–∏—Ñ–∞–º–∏</option>
          </select>
        </div>
        <div class="col-md-4 mb-3 d-flex align-items-end">
          <div class="form-check">
            <input class="form-check-input" type="checkbox" name="disable_notification" id="disable_notification">
            <label class="form-check-label" for="disable_notification">
              –û—Ç–ø—Ä–∞–≤–∏—Ç—å –±–µ–∑ –∑–≤—É–∫–∞
            </label>
          </div>
        </div>
      </div>
      
      <!-- –ù–û–í–´–ï –ö–ù–û–ü–ö–ò: –ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä –∏ –û—Ç–ø—Ä–∞–≤–∫–∞ -->
      <div class="d-flex gap-2">
        <button type="submit" name="action" value="preview" class="btn btn-outline-secondary">
          <i class="bi bi-eye"></i> –ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä (–æ—Ç–ø—Ä–∞–≤–∏—Ç—å –º–Ω–µ)
        </button>
        <button type="submit" name="action" value="send" class="btn btn-primary w-100" onclick="return confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ –∑–∞–ø—É—Å—Ç–∏—Ç—å —Ä–∞—Å—Å—ã–ª–∫—É?')">
          <i class="bi bi-send"></i> –û—Ç–ø—Ä–∞–≤–∏—Ç—å –≤—Å–µ–º
        </button>
      </div>
    </form>
  </div>
</div>

<!-- –°–∫—Ä–∏–ø—Ç –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —Å–∫—Ä—ã—Ç–∏—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π -->
<script>
  document.querySelectorAll('.alert[data-autohide]').forEach(el => {
    setTimeout(() => {
      el.classList.add('d-none');
    }, 5000);
  });
</script>